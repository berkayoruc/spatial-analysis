import"./modulepreload-polyfill-3cfb730f.js";import{m as $}from"./maplibre-gl-d8edafc8.js";import{h as b,j as p,r as U,l as I,p as k,k as x,m as D}from"./index-5775ba86.js";function E(t,a,e){e===void 0&&(e={});var o=b(t),s=b(a),i=p(s[1]-o[1]),n=p(s[0]-o[0]),c=p(o[1]),u=p(s[1]),l=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(n/2),2)*Math.cos(c)*Math.cos(u);return U(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),e.units)}function d(t,a,e,o){o===void 0&&(o={});var s=b(t),i=p(s[0]),n=p(s[1]),c=p(e),u=I(a,o.units),l=Math.asin(Math.sin(n)*Math.cos(u)+Math.cos(n)*Math.sin(u)*Math.cos(c)),v=i+Math.atan2(Math.sin(c)*Math.sin(u)*Math.cos(n),Math.cos(u)-Math.sin(n)*Math.sin(l)),M=x(v),w=x(l);return k([M,w],o.properties)}function B(t,a,e){e===void 0&&(e={});for(var o=e.steps||64,s=e.properties?e.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},i=[],n=0;n<o;n++)i.push(d(t,a,n*-360/o,e).geometry.coordinates);return i.push(i[0]),D([i],s)}const S={radius:4,minRadius:1,maxRadius:10},h=()=>S.radius,F=t=>S.radius=t,g=({center:t,steps:a})=>B(t,h(),{steps:a}),y=t=>{const a=t.target,{lat:e,lng:o}=a.getCenter(),{lat:s,lng:i}=t.lngLat;a.getCanvas().style.cursor="grabbing";let n=E([i,e],[o,e]),c=i;n<1&&(c=d([o,e],1,90,{units:"kilometers"}).geometry.coordinates[0],n=1),n>10&&(c=d([o,e],10,90,{units:"kilometers"}).geometry.coordinates[0],n=10);const u=document.getElementById("label-radius"),l=a.getSource("point-src"),v=a.getSource("circle-src");l.setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[c,l._data.features[0].geometry.coordinates[1]]}}]}),u.innerHTML=`Radius: ${n.toFixed(2)} km`;const M=document.getElementById("input-radius");M.value=n,F(n),v.setData({type:"FeatureCollection",features:[g({center:[o,e],steps:100})]})},C=t=>{const a=t.target;t.lngLat,a.getCanvas().style.cursor="",a.off("mousemove",y),a.off("touchmove",y)},j=""+new URL("chevron-right-double-b7c852f4.svg",import.meta.url).href;function z(t){return t.indexOf("mapbox:")===0}function O(t,a,e){if(t.indexOf("/styles/")>-1&&t.indexOf("/sprite")===-1)return{url:A(t,e)};if(t.indexOf("/sprites/")>-1)return{url:H(t,e)};if(t.indexOf("/fonts/")>-1)return{url:G(t,e)};if(t.indexOf("/v4/")>-1)return{url:R(t,e)};if(a==="Source")return{url:R(t,e)}}function m(t){const a=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/,e=t.match(a);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function f(t,a){const e=m("https://api.mapbox.com");t.protocol=e.protocol,t.authority=e.authority,t.params.push(`access_token=${a}`);const o=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${o}`}function A(t,a){const e=m(t);return e.path=`/styles/v1${e.path}`,f(e,a)}function G(t,a){const e=m(t);return e.path=`/fonts/v1${e.path}`,f(e,a)}function R(t,a){const e=m(t);return e.path=`/v4/${e.authority}.json`,e.params.push("secure"),f(e,a)}function H(t,a){const e=m(t);let o=e.path.split("."),s=o[0];const i=o[1];let n="";return s.indexOf("@2x")&&(s=s.split("@2x")[0],n="@2x"),e.path=`/styles/v1${s}/sprite${n}.${i}`,f(e,a)}const J=document.getElementById("btn-back");J.addEventListener("click",()=>{window.location.href="../index.html"});const T=(t,a)=>z(t)?O(t,a,"pk.eyJ1Ijoib3J1Y2JlIiwiYSI6ImNsbTZuZGxrZjBoN3czamxnM2V6aHBiZGEifQ.Fami0mGh65buxFjfJ0Ppjg"):{url:t},r=new $.Map({center:[29,41.015137],container:"mapContainer",style:"mapbox://styles/mapbox/streets-v12",zoom:11,transformRequest:T}),Z=document.getElementById("label-radius");Z.innerHTML=`Radius: ${h().toFixed(2)} km`;let L=new Image(48,32);L.onload=()=>r.addImage("radius-change-icon",L);L.src=j;const q=document.getElementById("input-radius");r.on("load",()=>{r.addSource("point-src",{type:"geojson",data:{type:"FeatureCollection",features:[d([29,41.015137],h(),90,{units:"kilometers"})]}}),r.addSource("circle-src",{type:"geojson",data:{type:"FeatureCollection",features:[g({center:[29,41.015137],steps:100})]}}),r.addLayer({id:"circle-lyr",type:"fill",source:"circle-src",paint:{"fill-color":"#369096","fill-opacity":.25}}),r.addLayer({id:"circle-outline-lyr",type:"line",source:"circle-src",paint:{"line-color":"#3DA0A8","line-width":2}}),r.addLayer({id:"point-lyr",source:"point-src",type:"symbol",layout:{"icon-image":"radius-change-icon","icon-size":1,"icon-allow-overlap":!0}}),r.on("mouseenter","point-lyr",()=>{r.getCanvas().style.cursor="move"}),r.on("mouseleave","point-lyr",()=>{r.getCanvas().style.cursor=""}),r.on("mousedown","point-lyr",t=>{t.preventDefault(),r.getCanvas().style.cursor="grab",r.on("mousemove",y),r.once("mouseup",C)}),r.on("touchstart","point-lyr",t=>{t.points.length===1&&(t.preventDefault(),r.on("touchmove",y),r.once("touchend",C))}),r.on("move",t=>{const a=t.target,{lat:e,lng:o}=a.getCenter(),s=a.getSource("point-src"),i=a.getSource("circle-src");s.setData({type:"FeatureCollection",features:[d([o,e],h(),90,{units:"kilometers"})]}),i.setData({type:"FeatureCollection",features:[g({center:[o,e],steps:100})]})}),q.addEventListener("input",t=>{const a=parseFloat(t.target.value);F(a);const e=document.getElementById("label-radius");e.innerHTML=`Radius: ${a.toFixed(2)} km`;const o=r.getCenter(),s=r.getSource("point-src"),i=r.getSource("circle-src");s.setData({type:"FeatureCollection",features:[d([o.lng,o.lat],a,90,{units:"kilometers"})]}),i.setData({type:"FeatureCollection",features:[g({center:[o.lng,o.lat],steps:100})]})})});
