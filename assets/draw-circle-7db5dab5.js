import"./modulepreload-polyfill-3cfb730f.js";import{c as h,d as l,r as I,l as w,p as x,h as M,j as D,m as b}from"./index-41b36d62.js";function T(e,t,r){r===void 0&&(r={});var a=h(e),i=h(t),s=l(i[1]-a[1]),n=l(i[0]-a[0]),d=l(a[1]),c=l(i[1]),u=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(n/2),2)*Math.cos(d)*Math.cos(c);return I(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}function p(e,t,r,a){a===void 0&&(a={});var i=h(e),s=l(i[0]),n=l(i[1]),d=l(r),c=w(t,a.units),u=Math.asin(Math.sin(n)*Math.cos(c)+Math.cos(n)*Math.sin(c)*Math.cos(d)),v=s+Math.atan2(Math.sin(d)*Math.sin(c)*Math.cos(n),Math.cos(c)-Math.sin(n)*Math.sin(u)),F=M(v),S=M(u);return x([F,S],a.properties)}function k(e,t,r){r===void 0&&(r={});for(var a=r.steps||64,i=r.properties?r.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},s=[],n=0;n<a;n++)s.push(p(e,t,n*-360/a,r).geometry.coordinates);return s.push(s[0]),D([s],i)}const L={radius:4,minRadius:1,maxRadius:10},m=()=>L.radius,R=e=>L.radius=e,g=({center:e,steps:t})=>k(e,m(),{steps:t}),y=e=>{const t=e.target,{lat:r,lng:a}=t.getCenter(),{lat:i,lng:s}=e.lngLat;t.getCanvas().style.cursor="grabbing";const n=T([s,r],[a,r]);if(n<.99||n>10.01)return;const d=document.getElementById("label-radius"),c=t.getSource("point-src"),u=t.getSource("circle-src");c.setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[s,c._data.features[0].geometry.coordinates[1]]}}]}),d.innerHTML=`Radius: ${n.toFixed(2)} km`;const v=document.getElementById("input-radius");v.value=n,R(n),u.setData({type:"FeatureCollection",features:[g({center:[a,r],steps:100})]})},C=e=>{const t=e.target;e.lngLat,t.getCanvas().style.cursor="",t.off("mousemove",y),t.off("touchmove",y)},j=""+new URL("chevron-right-double-b7c852f4.svg",import.meta.url).href;b.accessToken="pk.eyJ1Ijoib3J1Y2JlIiwiYSI6ImNsbTZuZGxrZjBoN3czamxnM2V6aHBiZGEifQ.Fami0mGh65buxFjfJ0Ppjg";const o=new b.Map({center:[29,41.015137],container:"mapContainer",style:"mapbox://styles/mapbox/streets-v12",zoom:11}),B=document.getElementById("label-radius");B.innerHTML=`Radius: ${m().toFixed(2)} km`;let f=new Image(48,32);f.onload=()=>o.addImage("radius-change-icon",f);f.src=j;const E=document.getElementById("input-radius");o.on("load",()=>{o.addSource("point-src",{type:"geojson",data:{type:"FeatureCollection",features:[p([29,41.015137],m(),90,{units:"kilometers"})]}}),o.addSource("circle-src",{type:"geojson",data:{type:"FeatureCollection",features:[g({center:[29,41.015137],steps:100})]}}),o.addLayer({id:"circle-lyr",type:"fill",source:"circle-src",paint:{"fill-color":"#369096","fill-opacity":.25}}),o.addLayer({id:"circle-outline-lyr",type:"line",source:"circle-src",paint:{"line-color":"#3DA0A8","line-width":2}}),o.addLayer({id:"point-lyr",source:"point-src",type:"symbol",layout:{"icon-image":"radius-change-icon","icon-size":1,"icon-allow-overlap":!0}}),o.on("mouseenter","point-lyr",()=>{o.getCanvas().style.cursor="move"}),o.on("mouseleave","point-lyr",()=>{o.getCanvas().style.cursor=""}),o.on("mousedown","point-lyr",e=>{e.preventDefault(),o.getCanvas().style.cursor="grab",o.on("mousemove",y),o.once("mouseup",C)}),o.on("touchstart","point-lyr",e=>{e.points.length===1&&(e.preventDefault(),o.on("touchmove",y),o.once("touchend",C))}),o.on("move",e=>{const t=e.target,{lat:r,lng:a}=t.getCenter(),i=t.getSource("point-src"),s=t.getSource("circle-src");i.setData({type:"FeatureCollection",features:[p([a,r],m(),90,{units:"kilometers"})]}),s.setData({type:"FeatureCollection",features:[g({center:[a,r],steps:100})]})}),E.addEventListener("input",e=>{const t=parseFloat(e.target.value);R(t);const r=document.getElementById("label-radius");r.innerHTML=`Radius: ${t.toFixed(2)} km`;const a=o.getCenter(),i=o.getSource("point-src"),s=o.getSource("circle-src");i.setData({type:"FeatureCollection",features:[p([a.lng,a.lat],t,90,{units:"kilometers"})]}),s.setData({type:"FeatureCollection",features:[g({center:[a.lng,a.lat],steps:100})]})})});
